var _st={request:function(t){var e={url:t.route||"",method:t.method||"GET",headers:t.headers||{},processData:!1,dataType:t.dataType||"json",success:function(e){void 0!==t.success&&t.success(e)},error:function(e,s,a){void 0!==t.error&&t.error([e,s,a])}};"GET"!==e.method&&(e.data=JSON.stringify(t.cdata||{})),void 0!==t.accepts&&(e.accepts=t.accepts),$.ajax(e)},menu:function(t){$("body").toggleClass("nav-sidebar-open"),"function"==typeof t&&t()},closer:function(t){jQuery("body").removeClass("nav-sidebar-open login-sidebar-open"),"function"==typeof t&&t()},heartBeat:function(){_st.request({route:stajax.rootURL+"/ping.php",success:function(t){try{if(!t)throw new Exception("Invalid response from _st.heartBeat.");do{$(document).dequeue("heartbeat")}while($(document).queue("heartbeat").length)}catch(t){console.log(t)}},error:function(t,e,s){Materialize.toast("Offline",6e3),console.log(t,e,s)}})},login:function(t){_st.request({route:stajax.rest.url+"/auth",headers:{"X-WP-Nonce":stajax.rest.nonce},success:function(e){t.append(e),_st.modal.loader()},error:function(t){console.log(t)}})},modal:($(".loading-spinner").each(function(t){$(this).attr("src",stajax.contentURL+"/i/sttv-spinner.gif")}),{action:"",element:$(".sttvmodal_inner"),init:function(t){if(void 0!==t){if(this.action===t)return this.toggle();var e;switch("close"!==t&&(this.action=t,_st.modal.loader(function(){_st.modal.element.empty()})),t){case"close":break;case"login":e=function(t){_st.login(t)};break;case"account":e=function(t){t.append("account template"),_st.modal.loader()};break;case"mu-checkout":e=function(t){_st.mu.submit(t,"#mu_form_wrapper")}}this.toggle(e)}},toggle:function(t){$("body").toggleClass("modal-open"),"function"==typeof t&&t(_st.modal.element)},loader:function(t){$("#sttvmodal").toggleClass("loader-active"),"function"==typeof t&&t(_st.modal.element)}}),cart:function(){if("courses"===stajax.type)return!1;var t=JSON.parse(localStorage.getItem("_stcart_")),e=Date.now();(null===t||30+(t.ID/1e3|0)<e/1e3|0)&&(t={ID:e,signature:btoa(navigator.userAgent+"|"+navigator.platform+"|"+navigator.product).replace(/=/g,""),items:{}});for(var s in t.items)"multi-user"===t.items[s].type&&delete t.items[s];var a=Object.keys(t.items).length,n=$("<div/>",{id:"cart-FAB"}),o=$("<a/>",{class:"cart-fab btn-floating btn-large z-depth-5"}),i=$("<i/>",{class:"material-icons",text:"shopping_cart"}),r=$("<div/>",{class:"cart-alert circle z-depth-2"});return $("body").addClass("sttv-jscart"),n.append(r.text(a)).append(o.append(i)).appendTo(document.body),a>0&&r.addClass("show").siblings(".cart-fab").addClass("pulse"),localStorage.setItem("_stcart_",JSON.stringify(t)),{cartObj:t,add:function(t,e){if(e=e||!1,"object"!=typeof t)return!1;var s=this.cartObj.items,a="";return void 0===s[t.id]?(s[t.id]=t,a="Item added"):(s[t.id].qty+=t.qty,a="Quantity updated"),this.save(e),a},remove:function(t,e){return e=e||!1,"string"==typeof t&&(delete this.cartObj.items[t],this.save(e))},empty:function(t){return this.cartObj.items={},this.save(),"function"==typeof t&&t(this)},save:function(t){return localStorage.setItem("_stcart_",JSON.stringify(this.cartObj)),!t&&this.notifications.update()},get:function(){return this.cartObj.items},notifications:{count:a,element:r,update:function(){return this.count=Object.keys(_st.cart.cartObj.items).length,this.count<=0?$(".cart-alert").removeClass("show").siblings(".cart-fab").removeClass("pulse"):$(".cart-alert").addClass("show").siblings(".cart-fab").addClass("pulse"),$(".cart-alert").text(this.count),this.count}}}}(),checkout:"",mu:{formValid:!1,disableForm:function(t){$(".signup-submit",t).prop("disabled",!this.formValid)},validate:function(t,e){$("input,select",e).each(function(t,s){if(!$(this).is(":required")||!($(this).val()&&!$(this).hasClass("invalid")||$(this).hasClass("valid")))return _st.mu.formValid=!1,_st.mu.disableForm(e),!1;_st.mu.formValid=!0}),_st.mu.disableForm(e)},submit:function(t,e){var s={mukey:$("input[name=mukey]",e).val(),email:$("input[name=email]",e).val(),license:{id:$("select[name=sttv_course_id]",e).val(),title:$("select[name=sttv_course_id] option:selected",e).text(),qty:$("select[name=qty]",e).val()}};_st.request({route:stajax.rest.url+"/multi-user",method:"POST",cdata:s,headers:{"X-WP-Nonce":stajax.rest.nonce},success:function(e){_st.checkout="multi-user",_st.cart.empty(function(t){t.add(e.data,!0)}),t.append(e.html),_st.modal.loader(),console.log(e)},error:function(t){var s=t[0].responseJSON;$(".message",e).text(s.message),_st.modal.toggle(function(){_st.modal.loader()}),console.log(s)}})}},fn:function(){}};!function(t){"use strict";t("input, select","#mu_form_wrapper").on("change",function(t){_st.mu.validate(this,"#mu_form_wrapper"),_st.modal.action=""});t(document).on("click touchstart",".slide-bar, .modal-toggle, .read-more, .mu-submitter, .cart-fab",function(e){e.preventDefault();var s=t(this),a={"modal-toggle":function(){_st.modal.init(s.attr("data-action"))},"slide-bar":function(){_st.menu()},"read-more":function(){s.parent().css({display:"none"}),t("#content-wrapper").css({"max-height":"none"})},"mu-submitter":function(){_st.modal.init("mu-checkout")},"cart-fab":function(){}};s.attr("class").split(/\s+/).some(function(t){void 0!==a[t]&&a[t]()})});var e=t("body.nav-sidebar-open #main-nav");e.on("click touchstart",function(t){t.offsetX>e.offsetWidth&&(alert("Clicked!"),t.preventDefault(),_st.closer())}),t("li.menu-item-has-children>a").click(function(e){e.preventDefault(),t(this).siblings("ul.sub-menu").toggleClass("active").promise().done(function(){t("ul.sub-menu").not(this).removeClass("active")})}),t(document).on("submit","form#sttv_login_form",function(e){if(e.preventDefault(),0!==t("#sttv_user").val().length){var s='<img src="'+stajax.contentURL+'/i/sttv-spinner.gif" alt="Loading..." />',a=t(".loading_overlay");a.append(s).promise().done(function(){t(this).fadeIn(250)}),_st.request({route:stajax.rest.url+"/auth?action=login",method:"POST",headers:{"X-WP-Nonce":stajax.rest.nonce,"X-STTV-Auth":btoa(this.sttv_user.value+":"+this.sttv_pass.value)},success:function(e){"login_success"==e.code&&(a.empty().html('<p class="sblock"><strong><i class="material-icons">done</i></strong></p>').fadeIn(250),t(".sblock").hide().fadeIn(250),setTimeout(function(){window.location.href=e.redirect},250))},error:function(e){var s=e[0].responseJSON,n=void 0!==s.errors.too_many_retries?s.errors.too_many_retries[0]:s.message;t(".message").html(n),a.fadeOut(250),console.log(s)}})}else t(".message").html("Username is required")}),t("form#sttv_contact").on("submit",function(e){e.preventDefault();var s=t(".loading_overlay",t(this).parent()).html('<img src="'+stajax.contentURL+'/i/sttv-spinner.gif" alt="Loading..." />');s.fadeIn(250),_st.request({route:stajax.rest.url+"/contact",method:"POST",headers:{"X-WP-Nonce":stajax.rest.nonce},cdata:{g_recaptcha_response:grecaptcha.getResponse(),sttv_contact_name:this.sttv_contact_name.value,sttv_contact_email:this.sttv_contact_email.value,sttv_contact_subject:this.sttv_contact_subject.value,sttv_contact_message:this.sttv_contact_message.value},success:function(e){if(console.log(e),e.sent){s.empty().html('<p class="sblock"><strong><i class="material-icons">done</i></strong></p>').fadeIn(250);var a=t(".sblock");t("<p/>",{class:"smessage"}).appendTo(a).append(e.message),t(".sblock").hide().fadeIn(250)}else t(".message").html(e.message),s.fadeOut(250)},error:function(e){t(".message").html("Something went wrong. Please refresh the page and try again."),s.fadeOut(250),console.log(e)}})}),t("#subscribe_page_mc").on("submit",function(e){e.preventDefault();var s=t(this),a=t(".loading_overlay",t(this).parent()).html('<img src="'+stajax.contentURL+'/i/sttv-spinner.gif" alt="Loading..." />');a.fadeIn(250);var n={fname:t("#sttv_mc_fname",s).val(),lname:t("#sttv_mc_lname",s).val(),email:t("#sttv_mc_email",s).val(),g_recaptcha_response:grecaptcha.getResponse()};_st.request({route:stajax.rest.url+"/subscribe",method:"POST",cdata:n,headers:{"X-WP-Nonce":stajax.rest.nonce},success:function(e){t("input, button",s).prop("disabled",!0),grecaptcha.reset(),a.empty().html('<p class="sblock"><strong><i class="material-icons">done</i></strong></p>').fadeIn(250);var n=t(".sblock");t("<p/>",{class:"smessage"}).appendTo(n).append(e.message),t(".sblock").hide().fadeIn(250),console.log(e)},error:function(e){t(".message",s).html("Something went wrong. Please refresh the page and try again."),a.fadeOut(250),console.log(e)}})})}(jQuery),function(t){"use strict";t(document).ready(function(){t("select").material_select()})}(jQuery);
//# sourceMappingURL=sttv-js.min.js.map
